# ТЗ:
**Выгрузка таблиц из build.in**  
Необходимо разработать программу, которая с помощью API сможет выгружать таблицы из build.in. При выгрузке, в таблицах
должны сохраняться не только значения, но и формулы в формате Excel. При обнаружение ссылки в текущей таблице на другую, ее необходимо добавить отдельным листом 
(реккурентные зависимости также необходимо обработать).

# Пояснения
После некоторого исследования на тему "Что такое build.in?" подходящего под контекст задания ответа не было найдено.
По заданию был сделан вывод, что так называемый build.in это просто некий тип БД, таблицы как в экселе,
 поэтому работа велась с таким вот представлением.

# Описание API
Есть всего два эндпоинта:
- GET /tables — получить список всех таблиц.
- GET /tables/{table_id} — получить конкретную таблицу по её *ID*, включая её ячейки, формулы и ссылки.  
  
Теперь в деталях.

### Логика
**GET /tables**  
Сервер возвращает простой список, где каждая запись содержит только базовые метаданные — *id* и *name* таблицы.  
ПРИМЕР ОТВЕТА: ***{ "tables": [ {"id": "table1", "name": "Бюджет"}, ... ] }***   
  
**GET /tables/{table_id}**  
Сервер находит таблицу по *{table_id}*, для каждой ячейки определяет её тип (значение, формула или ссылка на другую таблицу),
после нахождения пакует всё в джейсон и собственно отправляет его. Если находим поле *"link": {"table": "..."}*, значит эта ячейка
 ссылается на другую таблицу, соответственно рекурсивно вызываем *GET /tables/{table_id}* для каждой найденной ссылки, чтобы загрузить все зависимые таблицы.  
ПРИМЕР ОТВЕТА: ***{ "id": "...", "name": "...", "cells": [ ... ] }***  
  
# Описание классов  
- Table: Контейнер для ячеек  
- BaseCell/ValueCell/FormulaCell: ячейки. *ValueCell* и *FormulaCell* - дети *BaseCell*.  
- TBD сча лень писать да и пока не всё придумано
  
# Описание алгоритма работы (ИДЕЯ)
Пользователь вводит table_id  
    ↓  
APIClient.get_table(table_id)  
    ↓  
Парсинг → создание Table объекта  
    ↓  
Поиск link.table в ячейках  
    ↓  
Для каждой найденной ссылки:  
    APIClient.get_table(linked_table_id)  
    ↓  
Рекурсивно загружаем все связанные таблицы  
    ↓  
DependencyResolver анализирует зависимости  
    ↓  
ExcelWriter генерирует .xlsx файл  
    ↓  
Каждая таблица → отдельный лист  
  
# Запуск  
Зависимости не забываем  
```
pip install -r requirements.txt
```
  
Экспорт таблицы  
```
python main.py --table-id table_123 --output name.xlsx
```
  
Тестики  
```
python main.py --test --table-id table_123
```